#include <Arduino.h>
#include <WiFi.h>
#include <WebServer.h>
#include <WebSocketsServer.h>
#include <ESPmDNS.h>
#include <ArduinoJson.h>

// â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
// ğŸ•µï¸â€â™‚ï¸ Ù†Ø¸Ø§Ù… RTX-GHOST - ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ ESP32 Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ‚Ù„
// â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

// ğŸŒ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù†Ù‚Ø·Ø© Ø§Ù„ÙˆØµÙˆÙ„
const char* AP_SSID = "RTX-GHOST-CONTROL";
const char* AP_PASSWORD = "ghost123456";

// ğŸ–¥ï¸ Ø®ÙˆØ§Ø¯Ù… Ø§Ù„ÙˆÙŠØ¨
WebServer server(80);
WebSocketsServer webSocket(81);

// ğŸ¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
String currentTheme = "dark";
String language = "ar";
bool rtlEnabled = true;
bool largeText = false;

// ğŸ“Š Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
String eventLog = "";
bool systemActive = true;

// âš¡ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
bool stealthMode = true;
bool wifiScanning = false;
bool bluetoothActive = false;
bool attackRunning = false;

class RTXGhostSystem {
private:
    unsigned long lastScan = 0;
    int connectedClients = 0;

public:
    void begin() {
        Serial.begin(115200);
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
        initializeSystem();
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù‚Ø·Ø© Ø§Ù„ÙˆØµÙˆÙ„
        createAccessPoint();
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø§Ø¯Ù… Ø§Ù„ÙˆÙŠØ¨
        setupWebServer();
        
        // Ø¨Ø¯Ø¡ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        startServices();
        
        addToLog("ğŸš€ Ù†Ø¸Ø§Ù… RTX-GHOST Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ´ØºÙŠÙ„", "success");
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ¯ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void initializeSystem() {
        // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ©
        disableLogging();
        
        // ØªÙ‡ÙŠØ¦Ø© Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØªØ®ÙÙŠ
        initializeStealth();
        
        addToLog("ğŸ”§ ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ", "system");
    }

    void disableLogging() {
        // ØªØ¹Ø·ÙŠÙ„ Ø¨Ø¹Ø¶ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø±
        esp_log_level_set("*", ESP_LOG_ERROR);
    }

    void initializeStealth() {
        // ØªØºÙŠÙŠØ± Ø¹Ù†ÙˆØ§Ù† MAC Ø¹Ø´ÙˆØ§Ø¦ÙŠ
        uint8_t newMAC[] = {0x02, 0x00, 0x00, 
                           random(256), random(256), random(256)};
        esp_wifi_set_mac(WIFI_IF_STA, newMAC);
        
        addToLog("ğŸ‘» Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ®ÙÙŠ Ø§Ù„Ù…ÙØ¹Ù„", "stealth");
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ“¡ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù‚Ø·Ø© Ø§Ù„ÙˆØµÙˆÙ„
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void createAccessPoint() {
        WiFi.softAP(AP_SSID, AP_PASSWORD);
        
        Serial.println("\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
        Serial.println("â•‘        Ù†Ø¸Ø§Ù… RTX-GHOST Ù†Ø´Ø·         â•‘");
        Serial.println("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£");
        Serial.println("â•‘ SSID: RTX-GHOST-CONTROL           â•‘");
        Serial.println("â•‘ IP: 192.168.4.1                   â•‘");
        Serial.println("â•‘ Password: ghost123456             â•‘");
        Serial.println("â•‘                                   â•‘");
        Serial.println("â•‘ âš¡ Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø´Ø¨ÙƒØ© ÙˆØ§ÙØªØ­ Ø§Ù„Ù…ØªØµÙØ­     â•‘");
        Serial.println("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        
        addToLog("ğŸ“¡ Ù†Ù‚Ø·Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ù†Ø´Ø·Ø©: " + String(AP_SSID), "network");
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸŒ Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø§Ø¯Ù… Ø§Ù„ÙˆÙŠØ¨
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void setupWebServer() {
        // ğŸ“„ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        server.on("/", HTTP_GET, [this]() {
            serveMainPage();
        });

        // âš”ï¸ Ù†Ù‚Ø§Ø· Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù‡Ø¬Ù…Ø§Øª
        server.on("/attack/start", HTTP_POST, [this]() {
            handleAttackStart();
        });

        server.on("/attack/stop", HTTP_POST, [this]() {
            handleAttackStop();
        });

        server.on("/scan/networks", HTTP_POST, [this]() {
            handleNetworkScan();
        });

        server.on("/scan/bluetooth", HTTP_POST, [this]() {
            handleBluetoothScan();
        });

        // âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        server.on("/settings/update", HTTP_POST, [this]() {
            handleSettingsUpdate();
        });

        // ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        server.on("/system/info", HTTP_GET, [this]() {
            handleSystemInfo();
        });

        server.on("/system/status", HTTP_GET, [this]() {
            handleSystemStatus();
        });

        server.on("/logs", HTTP_GET, [this]() {
            handleLogsRequest();
        });

        // ğŸ›¡ï¸ Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù…Ø§Ù†
        server.on("/security/stealth", HTTP_POST, [this]() {
            handleStealthToggle();
        });

        server.on("/security/clean", HTTP_POST, [this]() {
            handleCleanTraces();
        });

        server.begin();
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ¨ Ø®Ø¯Ù…Ø© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void serveMainPage() {
        String html = generateMainHTML();
        server.send(200, "text/html; charset=utf-8", html);
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // âš”ï¸ Ø¨Ø¯Ø¡ Ø§Ù„Ù‡Ø¬Ù…Ø§Øª
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void handleAttackStart() {
        String attackType = server.arg("type");
        String target = server.arg("target");
        
        addToLog("ğŸ¯ Ø¨Ø¯Ø¡ Ø§Ù„Ù‡Ø¬ÙˆÙ…: " + attackType + " Ø¹Ù„Ù‰ " + target, "attack");
        
        if (attackType == "wifi_deauth") {
            startDeauthAttack(target);
        } else if (attackType == "wifi_spoof") {
            startSpoofingAttack();
        } else if (attackType == "bluetooth_scan") {
            startBluetoothScan();
        } else if (attackType == "packet_sniff") {
            startPacketSniffing();
        }
        
        server.send(200, "application/json", "{\"status\":\"success\"}");
    }

    void handleAttackStop() {
        attackRunning = false;
        addToLog("â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‡Ø¬Ù…Ø§Øª", "system");
        server.send(200, "application/json", "{\"status\":\"stopped\"}");
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ“¡ Ù…Ø³Ø­ Ø§Ù„Ø´Ø¨ÙƒØ§Øª
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void handleNetworkScan() {
        addToLog("ğŸ” Ø¨Ø¯Ø¡ Ù…Ø³Ø­ Ø§Ù„Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ù„Ø§Ø³Ù„ÙƒÙŠØ©...", "scan");
        
        // Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ø³Ø­ Ø§Ù„Ø´Ø¨ÙƒØ§Øª
        String networks = simulateNetworkScan();
        
        server.send(200, "application/json", "{\"networks\":" + networks + "}");
    }

    String simulateNetworkScan() {
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø§ÙƒØªØ´Ø§Ù Ø´Ø¨ÙƒØ§Øª
        String networks = "[";
        networks += "{\"ssid\":\"Home-Network\", \"signal\":\"-45dBm\", \"encryption\":\"WPA2\"},";
        networks += "{\"ssid\":\"Free-WiFi\", \"signal\":\"-62dBm\", \"encryption\":\"Open\"},";
        networks += "{\"ssid\":\"Office-Secure\", \"signal\":\"-38dBm\", \"encryption\":\"WPA3\"},";
        networks += "{\"ssid\":\"AndroidAP\", \"signal\":\"-71dBm\", \"encryption\":\"WPA2\"}";
        networks += "]";
        
        addToLog("ğŸ“Š ØªÙ… Ø§ÙƒØªØ´Ø§Ù 4 Ø´Ø¨ÙƒØ§Øª Ù„Ø§Ø³Ù„ÙƒÙŠØ©", "scan");
        return networks;
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ“± Ù…Ø³Ø­ Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void handleBluetoothScan() {
        addToLog("ğŸ“± Ø¨Ø¯Ø¡ Ù…Ø³Ø­ Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«...", "scan");
        
        // Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ø³Ø­ Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«
        String devices = simulateBluetoothScan();
        
        server.send(200, "application/json", "{\"devices\":" + devices + "}");
    }

    String simulateBluetoothScan() {
        String devices = "[";
        devices += "{\"name\":\"iPhone 13\", \"type\":\"Phone\", \"signal\":\"-50dBm\"},";
        devices += "{\"name\":\"Samsung Galaxy\", \"type\":\"Phone\", \"signal\":\"-55dBm\"},";
        devices += "{\"name\":\"AirPods Pro\", \"type\":\"Audio\", \"signal\":\"-65dBm\"},";
        devices += "{\"name\":\"Smart Watch\", \"type\":\"Wearable\", \"signal\":\"-70dBm\"}";
        devices += "]";
        
        addToLog("ğŸ“± ØªÙ… Ø§ÙƒØªØ´Ø§Ù 4 Ø£Ø¬Ù‡Ø²Ø© Ø¨Ù„ÙˆØªÙˆØ«", "scan");
        return devices;
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // âš™ï¸ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void handleSettingsUpdate() {
        if (server.hasArg("theme")) {
            currentTheme = server.arg("theme");
            addToLog("ğŸ¨ ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ù…Ø© Ø¥Ù„Ù‰: " + currentTheme, "settings");
        }
        
        if (server.hasArg("language")) {
            language = server.arg("lang");
            rtlEnabled = (language == "ar");
            addToLog("ğŸˆ³ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© Ø¥Ù„Ù‰: " + language, "settings");
        }
        
        if (server.hasArg("largeText")) {
            largeText = server.arg("largeText") == "true";
            addToLog("ğŸ” ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ù†Øµ: " + String(largeText ? "ÙƒØ¨ÙŠØ±" : "Ø¹Ø§Ø¯ÙŠ"), "settings");
        }
        
        server.send(200, "application/json", "{\"status\":\"updated\"}");
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void handleSystemInfo() {
        DynamicJsonDocument doc(1024);
        doc["chip_model"] = "ESP32";
        doc["chip_revision"] = ESP.getChipRevision();
        doc["cpu_freq"] = ESP.getCpuFreqMHz();
        doc["flash_size"] = ESP.getFlashChipSize();
        doc["free_heap"] = ESP.getFreeHeap();
        doc["ssid"] = AP_SSID;
        doc["ip"] = "192.168.4.1";
        doc["clients"] = connectedClients;
        
        String response;
        serializeJson(doc, response);
        server.send(200, "application/json", response);
    }

    void handleSystemStatus() {
        DynamicJsonDocument doc(512);
        doc["stealth_mode"] = stealthMode;
        doc["system_active"] = systemActive;
        doc["attack_running"] = attackRunning;
        doc["wifi_scanning"] = wifiScanning;
        doc["bluetooth_active"] = bluetoothActive;
        
        String response;
        serializeJson(doc, response);
        server.send(200, "application/json", response);
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ“ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void handleLogsRequest() {
        server.send(200, "application/json", "{\"logs\":\"" + eventLog + "\"}");
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ›¡ï¸ Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù…Ø§Ù†
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void handleStealthToggle() {
        stealthMode = !stealthMode;
        addToLog(stealthMode ? "ğŸ‘» ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØªØ®ÙÙŠ" : "ğŸ‘€ ØªØ¹Ø·ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØªØ®ÙÙŠ", "stealth");
        server.send(200, "application/json", "{\"stealth_mode\":" + String(stealthMode) + "}");
    }

    void handleCleanTraces() {
        addToLog("ğŸ§¹ Ø¨Ø¯Ø¡ Ù…Ø­Ùˆ Ø§Ù„Ø¢Ø«Ø§Ø±...", "security");
        
        // Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ø­Ùˆ Ø§Ù„Ø¢Ø«Ø§Ø±
        eventLog = "";
        addToLog("âœ… ØªÙ… Ù…Ø­Ùˆ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¢Ø«Ø§Ø±", "security");
        
        server.send(200, "application/json", "{\"status\":\"cleaned\"}");
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ”„ Ø¥Ø¯Ø§Ø±Ø© WebSocket
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void webSocketEvent(uint8_t num, WStype_t type, uint8_t * payload, size_t length) {
        switch(type) {
            case WStype_DISCONNECTED:
                connectedClients--;
                addToLog("ğŸ”Œ Ø§Ù†Ù‚Ø·Ø¹ Ø§ØªØµØ§Ù„ Ø§Ù„Ø¹Ù…ÙŠÙ„", "network");
                break;
                
            case WStype_CONNECTED:
                connectedClients++;
                addToLog("ğŸ”Œ Ø§ØªØµØ§Ù„ Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©", "network");
                sendSystemStatus();
                break;
                
            case WStype_TEXT:
                handleWebSocketMessage((char*)payload);
                break;
        }
    }

    void handleWebSocketMessage(char* payload) {
        DynamicJsonDocument doc(256);
        deserializeJson(doc, payload);
        
        String command = doc["command"];
        if (command == "get_status") {
            sendSystemStatus();
        } else if (command == "get_logs") {
            sendLogsUpdate();
        } else if (command == "start_scan") {
            startNetworkScan();
        }
    }

    void sendSystemStatus() {
        DynamicJsonDocument doc(512);
        doc["type"] = "status_update";
        doc["stealth_mode"] = stealthMode;
        doc["system_active"] = systemActive;
        doc["attack_running"] = attackRunning;
        doc["connected_clients"] = connectedClients;
        doc["free_memory"] = ESP.getFreeHeap();
        
        String response;
        serializeJson(doc, response);
        webSocket.broadcastTXT(response);
    }

    void sendLogsUpdate() {
        DynamicJsonDocument doc(1024);
        doc["type"] = "logs_update";
        doc["logs"] = eventLog;
        
        String response;
        serializeJson(doc, response);
        webSocket.broadcastTXT(response);
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // âš”ï¸ ØªÙ†ÙÙŠØ° Ø§Ù„Ù‡Ø¬Ù…Ø§Øª
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void startDeauthAttack(String target) {
        attackRunning = true;
        addToLog("ğŸ¯ Ø¨Ø¯Ø¡ Ù‡Ø¬ÙˆÙ… Deauth Ø¹Ù„Ù‰: " + target, "attack");
        
        // Ù…Ø­Ø§ÙƒØ§Ø© Ù‡Ø¬ÙˆÙ… deauth
        for(int i = 1; i <= 10; i++) {
            if (!attackRunning) break;
            
            addToLog("ğŸ“¡ Ø¥Ø±Ø³Ø§Ù„ Ø­Ø²Ù… Deauth (" + String(i) + "/10)", "attack");
            delay(1000);
        }
        
        attackRunning = false;
        addToLog("âœ… Ø§Ù†ØªÙ‡Ù‰ Ù‡Ø¬ÙˆÙ… Deauth", "attack");
    }

    void startSpoofingAttack() {
        attackRunning = true;
        addToLog("ğŸ­ Ø¨Ø¯Ø¡ Ù‡Ø¬ÙˆÙ… Ø§Ù†ØªØ­Ø§Ù„ Ø§Ù„Ø´Ø¨ÙƒØ§Øª", "attack");
        
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø¨ÙƒØ§Øª ÙˆÙ‡Ù…ÙŠØ©
        String fakeNetworks[] = {"Free-WiFi", "Airport-Network", "Hotel-Guest", "Public-WiFi"};
        
        for(int i = 0; i < 4 && attackRunning; i++) {
            addToLog("ğŸ“¡ Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø¨ÙƒØ© ÙˆÙ‡Ù…ÙŠØ©: " + fakeNetworks[i], "attack");
            delay(800);
        }
        
        attackRunning = false;
        addToLog("âœ… Ø§Ù†ØªÙ‡Ù‰ Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø§Ù†ØªØ­Ø§Ù„", "attack");
    }

    void startBluetoothScan() {
        bluetoothActive = true;
        addToLog("ğŸ“± Ø¨Ø¯Ø¡ Ù…Ø³Ø­ Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ« Ø§Ù„Ù…ØªÙ‚Ø¯Ù…", "scan");
        delay(2000);
        bluetoothActive = false;
        addToLog("ğŸ“± Ø§Ù†ØªÙ‡Ù‰ Ù…Ø³Ø­ Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«", "scan");
    }

    void startPacketSniffing() {
        attackRunning = true;
        addToLog("ğŸ“¡ Ø¨Ø¯Ø¡ ØªØµÙ†Øª Ø§Ù„Ø­Ø²Ù…", "attack");
        
        // Ù…Ø­Ø§ÙƒØ§Ø© ØªØµÙ†Øª Ø§Ù„Ø­Ø²Ù…
        for(int i = 1; i <= 5 && attackRunning; i++) {
            addToLog("ğŸ“¦ Ø§Ø¹ØªØ±Ø§Ø¶ Ø­Ø²Ù…Ø© Ø¨ÙŠØ§Ù†Ø§Øª #" + String(i), "attack");
            delay(1200);
        }
        
        attackRunning = false;
        addToLog("âœ… Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ØªØµÙ†Øª", "attack");
    }

    void startNetworkScan() {
        wifiScanning = true;
        addToLog("ğŸ” Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø³Ø­ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ø´Ø¨ÙƒØ§Øª", "scan");
        delay(3000);
        wifiScanning = false;
        addToLog("ğŸ” Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ù…Ø³Ø­ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…", "scan");
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void addToLog(String message, String type) {
        String timestamp = getTimestamp();
        String logEntry = "[" + timestamp + "] " + message;
        
        eventLog += logEntry + "\n";
        
        // Ø¥Ø±Ø³Ø§Ù„ ØªØ­Ø¯ÙŠØ« Ø¹Ø¨Ø± WebSocket
        DynamicJsonDocument doc(512);
        doc["type"] = "new_log";
        doc["log"] = logEntry;
        doc["log_type"] = type;
        
        String response;
        serializeJson(doc, response);
        webSocket.broadcastTXT(response);
        
        // Ø·Ø¨Ø§Ø¹Ø© ÙÙŠ Serial
        Serial.println(logEntry);
    }

    String getTimestamp() {
        unsigned long seconds = millis() / 1000;
        unsigned long minutes = seconds / 60;
        unsigned long hours = minutes / 60;
        
        char timestamp[12];
        sprintf(timestamp, "%02lu:%02lu:%02lu", hours % 24, minutes % 60, seconds % 60);
        return String(timestamp);
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void startServices() {
        webSocket.begin();
        webSocket.onEvent([this](uint8_t num, WStype_t type, uint8_t * payload, size_t length) {
            this->webSocketEvent(num, type, payload, length);
        });
        
        addToLog("ğŸŒ Ø®Ø¯Ù…Ø§Øª Ø§Ù„ÙˆÙŠØ¨ Ù†Ø´Ø·Ø©", "system");
        addToLog("ğŸ”— WebSocket Ø¬Ø§Ù‡Ø² Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° 81", "system");
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ”„ Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    void run() {
        server.handleClient();
        webSocket.loop();
        
        // Ø¥Ø±Ø³Ø§Ù„ ØªØ­Ø¯ÙŠØ«Ø§Øª Ø¯ÙˆØ±ÙŠØ© Ù„Ù„Ø­Ø§Ù„Ø©
        static unsigned long lastUpdate = 0;
        if (millis() - lastUpdate > 2000) {
            lastUpdate = millis();
            sendSystemStatus();
        }
    }

    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // ğŸ¨ ØªÙˆÙ„ÙŠØ¯ ÙˆØ§Ø¬Ù‡Ø© HTML
    // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    String generateMainHTML() {
        String html = R"raw(
<!DOCTYPE html>
<html dir=")raw" + String(rtlEnabled ? "rtl" : "ltr") + R"raw(" lang=")raw" + language + R"raw(">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… RTX-GHOST - ESP32</title>
    <style>
        :root {
            --primary: #00ff88;
            --primary-dark: #00cc6a;
            --danger: #ff4444;
            --warning: #ffaa00;
            --info: #0088ff;
            --bg-dark: #0a0a0a;
            --bg-card: #1a1a1a;
            --text: #ffffff;
            --border: #333;
        }
        
        .theme-light {
            --bg-dark: #f0f0f0;
            --bg-card: #ffffff;
            --text: #333333;
            --border: #ddd;
        }
        
        .large-text { font-size: 1.2em; }
        .rtl { direction: rtl; text-align: right; }
        .ltr { direction: ltr; text-align: left; }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            transition: all 0.3s ease;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container { max-width: 1200px; margin: 0 auto; }
        
        .header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 3px solid var(--primary);
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: var(--primary);
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .status-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .status-card {
            background: var(--bg-card);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .status-card.warning { border-left-color: var(--warning); }
        .status-card.danger { border-left-color: var(--danger); }
        .status-card.info { border-left-color: var(--info); }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .grid { grid-template-columns: 1fr; }
        }
        
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .card h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
            font-size: 1.4em;
        }
        
        .btn {
            background: var(--primary);
            color: #000;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
            transition: all 0.3s ease;
            display: inline-block;
            text-decoration: none;
        }
        
        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,255,136,0.3);
        }
        
        .btn-danger { background: var(--danger); color: white; }
        .btn-warning { background: var(--warning); color: black; }
        .btn-info { background: var(--info); color: white; }
        
        .btn-sm { padding: 8px 15px; font-size: 0.9em; }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 5px;
            background: var(--bg-dark);
            color: var(--text);
            font-size: 1em;
        }
        
        .log-container {
            height: 400px;
            overflow-y: auto;
            background: #000;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.4;
        }
        
        .log-entry {
            margin-bottom: 8px;
            padding: 5px 10px;
            border-radius: 4px;
            border-left: 3px solid var(--primary);
        }
        
        .log-success { border-left-color: var(--primary); background: rgba(0,255,136,0.05); }
        .log-attack { border-left-color: var(--danger); background: rgba(255,68,68,0.05); }
        .log-stealth { border-left-color: #8000ff; background: rgba(128,0,255,0.05); }
        .log-scan { border-left-color: var(--info); background: rgba(0,136,255,0.05); }
        .log-system { border-left-color: var(--warning); background: rgba(255,170,0,0.05); }
        .log-network { border-left-color: #00ffff; background: rgba(0,255,255,0.05); }
        
        .settings-panel {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .indicator-online { background: var(--primary); box-shadow: 0 0 10px var(--primary); }
        .indicator-offline { background: var(--danger); }
        .indicator-warning { background: var(--warning); }
        
        .attack-progress {
            width: 100%;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class=")raw" + (currentTheme == "light" ? "theme-light" : "") + " " + (largeText ? "large-text" : "") + " " + (rtlEnabled ? "rtl" : "ltr") + R"raw(">
    <div class="container">
        <div class="header">
            <h1>ğŸ•µï¸â€â™‚ï¸ Ù†Ø¸Ø§Ù… RTX-GHOST - ESP32</h1>
            <p>Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø³ØªÙ‚Ù„ Ù„Ù„Ù‡Ø¬Ù…Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©</p>
        </div>
        
        <div class="status-bar">
            <div class="status-card" id="statusStealth">
                <span class="indicator indicator-online"></span>
                <strong>ÙˆØ¶Ø¹ Ø§Ù„ØªØ®ÙÙŠ:</strong> <span id="stealthStatus">Ù†Ø´Ø·</span>
            </div>
            <div class="status-card" id="statusSystem">
                <span class="indicator indicator-online"></span>
                <strong>Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…:</strong> <span id="systemStatus">Ù†Ø´Ø·</span>
            </div>
            <div class="status-card" id="statusAttack">
                <span class="indicator indicator-offline"></span>
                <strong>Ø§Ù„Ù‡Ø¬Ù…Ø§Øª:</strong> <span id="attackStatus">Ù…ØªÙˆÙ‚Ù</span>
            </div>
            <div class="status-card info" id="statusClients">
                <span class="indicator indicator-online"></span>
                <strong>Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª:</strong> <span id="clientsCount">0</span>
            </div>
        </div>
        
        <div class="settings-panel">
            <select id="themeSelect" class="btn btn-sm">
                <option value="dark">ğŸŒ™ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¸Ù„Ù…</option>
                <option value="light">â˜€ï¸ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­</option>
            </select>
            
            <select id="languageSelect" class="btn btn-sm">
                <option value="ar">ğŸˆ³ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                <option value="en">ğŸˆ´ English</option>
            </select>
            
            <button class="btn btn-sm" onclick="toggleTextSize()" id="textSizeBtn">
                ğŸ” ØªÙƒØ¨ÙŠØ± Ø§Ù„Ù†Øµ
            </button>
            
            <button class="btn btn-sm btn-info" onclick="refreshStatus()">
                ğŸ”„ ØªØ­Ø¯ÙŠØ«
            </button>
        </div>
        
        <div class="grid">
            <!-- Ø¨Ø·Ø§Ù‚Ø© Ù‡Ø¬Ù…Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ§Øª -->
            <div class="card">
                <h2>ğŸ“¡ Ù‡Ø¬Ù…Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ù„Ø§Ø³Ù„ÙƒÙŠØ©</h2>
                <div class="control-group">
                    <label>Ù‡Ø¬Ù…Ø§Øª WiFi:</label>
                    <button class="btn btn-sm btn-danger" onclick="startAttack('wifi_deauth', 'all')">
                        ğŸ¯ Ù‡Ø¬ÙˆÙ… Deauth
                    </button>
                    <button class="btn btn-sm btn-warning" onclick="startAttack('wifi_spoof', '')">
                        ğŸ­ Ø§Ù†ØªØ­Ø§Ù„ Ø´Ø¨ÙƒØ§Øª
                    </button>
                    <button class="btn btn-sm btn-info" onclick="startNetworkScan()">
                        ğŸ” Ù…Ø³Ø­ Ø§Ù„Ø´Ø¨ÙƒØ§Øª
                    </button>
                </div>
                
                <div class="control-group">
                    <label>ØªØµÙ†Øª Ø§Ù„Ø­Ø²Ù…:</label>
                    <button class="btn btn-sm btn-info" onclick="startAttack('packet_sniff', '')">
                        ğŸ“¡ Ø§Ø¹ØªØ±Ø§Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </button>
                </div>
                
                <div class="control-group">
                    <label>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡Ø¬Ù…Ø§Øª:</label>
                    <button class="btn btn-sm" onclick="stopAllAttacks()">
                        â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒÙ„
                    </button>
                </div>
            </div>
            
            <!-- Ø¨Ø·Ø§Ù‚Ø© Ù‡Ø¬Ù…Ø§Øª Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ« -->
            <div class="card">
                <h2>ğŸ“± Ù‡Ø¬Ù…Ø§Øª Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«</h2>
                <div class="control-group">
                    <label>Ù…Ø³Ø­ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©:</label>
                    <button class="btn btn-sm btn-info" onclick="startBluetoothScan()">
                        ğŸ“± Ù…Ø³Ø­ Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«
                    </button>
                    <button class="btn btn-sm btn-warning" onclick="startAttack('bluetooth_spoof', '')">
                        ğŸ­ Ø§Ù†ØªØ­Ø§Ù„ Ø£Ø¬Ù‡Ø²Ø©
                    </button>
                </div>
                
                <div class="control-group">
                    <label>Ù‡Ø¬Ù…Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©:</label>
                    <button class="btn btn-sm btn-danger" onclick="showAdvancedBluetooth()">
                        âš¡ Ù‡Ø¬Ù…Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©
                    </button>
                </div>
            </div>
            
            <!-- Ø¨Ø·Ø§Ù‚Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù…Ø§Ù† -->
            <div class="card">
                <h2>ğŸ›¡ï¸ Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„ØªØ®ÙÙŠ</h2>
                <div class="control-group">
                    <label>ÙˆØ¶Ø¹ Ø§Ù„ØªØ®ÙÙŠ:</label>
                    <button class="btn btn-sm" onclick="toggleStealth()" id="stealthBtn">
                        ğŸ‘» ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ®ÙÙŠ
                    </button>
                </div>
                
                <div class="control-group">
                    <label>Ù…Ø­Ùˆ Ø§Ù„Ø¢Ø«Ø§Ø±:</label>
                    <button class="btn btn-sm btn-warning" onclick="cleanTraces()">
                        ğŸ§¹ Ù…Ø­Ùˆ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                    </button>
                    <button class="btn btn-sm btn-danger" onclick="showDestructConfirm()">
                        ğŸ’¥ ØªØ¯Ù…ÙŠØ± Ø¢Ù…Ù†
                    </button>
                </div>
                
                <div class="control-group">
                    <label>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…:</label>
                    <button class="btn btn-sm btn-info" onclick="showSystemInfo()">
                        ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙØµÙ„Ø©
                    </button>
                </div>
            </div>
            
            <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª -->
            <div class="card">
                <h2>ğŸ“ Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</h2>
                <div class="log-container" id="logContainer">
                    <!-- Ø§Ù„Ø³Ø¬Ù„Ø§Øª ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                </div>
                <div style="margin-top: 15px;">
                    <button class="btn btn-sm" onclick="clearLogs()">
                        ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                    </button>
                    <button class="btn btn-sm btn-info" onclick="refreshLogs()">
                        ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let ws;
        let isConnected = false;
        
        // ğŸ”„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ WebSocket
        function connectWebSocket() {
            const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsUrl = protocol + '//' + window.location.hostname + ':81';
            
            ws = new WebSocket(wsUrl);
            
            ws.onopen = function() {
                isConnected = true;
                addLog('ğŸ”Œ Ù…ØªØµÙ„ Ø¨Ù†Ø¸Ø§Ù… RTX-GHOST', 'system');
                updateStatusIndicator(true);
            };
            
            ws.onmessage = function(event) {
                const data = JSON.parse(event.data);
                
                if (data.type === 'new_log') {
                    addLog(data.log, data.log_type);
                } else if (data.type === 'status_update') {
                    updateStatusDisplay(data);
                } else if (data.type === 'logs_update') {
                    loadLogs(data.logs);
                }
            };
            
            ws.onclose = function() {
                isConnected = false;
                addLog('ğŸ”Œ Ø§Ù†Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù†Ø¸Ø§Ù…', 'system');
                updateStatusIndicator(false);
                setTimeout(connectWebSocket, 3000);
            };
            
            ws.onerror = function(error) {
                console.error('WebSocket error:', error);
            };
        }
        
        // ğŸ“Š ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø©
        function updateStatusDisplay(data) {
            document.getElementById('stealthStatus').textContent = 
                data.stealth_mode ? 'Ù†Ø´Ø·' : 'ØºÙŠØ± Ù†Ø´Ø·';
            document.getElementById('systemStatus').textContent = 
                data.system_active ? 'Ù†Ø´Ø·' : 'Ù…ØªÙˆÙ‚Ù';
            document.getElementById('attackStatus').textContent = 
                data.attack_running ? 'Ù†Ø´Ø·' : 'Ù…ØªÙˆÙ‚Ù';
            document.getElementById('clientsCount').textContent = 
                data.connected_clients;
                
            // ØªØ­Ø¯ÙŠØ« Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª
            updateStatusIndicator(true);
        }
        
        function updateStatusIndicator(online) {
            const indicators = {
                statusStealth: online ? 'indicator-online' : 'indicator-offline',
                statusSystem: online ? 'indicator-online' : 'indicator-offline',
                statusAttack: document.getElementById('attackStatus').textContent === 'Ù†Ø´Ø·' ? 
                            'indicator-warning' : 'indicator-offline',
                statusClients: online ? 'indicator-online' : 'indicator-offline'
            };
            
            for (const [id, className] of Object.entries(indicators)) {
                const indicator = document.querySelector(`#${id} .indicator`);
                if (indicator) {
                    indicator.className = 'indicator ' + className;
                }
            }
        }
        
        // ğŸ“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª
        function addLog(message, type) {
            const container = document.getElementById('logContainer');
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry log-' + type;
            logEntry.textContent = message;
            container.appendChild(logEntry);
            container.scrollTop = container.scrollHeight;
        }
        
        function loadLogs(logs) {
            const container = document.getElementById('logContainer');
            container.innerHTML = '';
            const logArray = logs.split('\n');
            logArray.forEach(log => {
                if (log.trim()) {
                    const logEntry = document.createElement('div');
                    logEntry.className = 'log-entry log-system';
                    logEntry.textContent = log;
                    container.appendChild(logEntry);
                }
            });
            container.scrollTop = container.scrollHeight;
        }
        
        function clearLogs() {
            document.getElementById('logContainer').innerHTML = '';
        }
        
        function refreshLogs() {
            fetch('/logs')
                .then(response => response.json())
                .then(data => loadLogs(data.logs));
        }
        
        // âš”ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡Ø¬Ù…Ø§Øª
        function startAttack(type, target) {
            const formData = new FormData();
            formData.append('type', type);
            formData.append('target', target);
            
            fetch('/attack/start', {
                method: 'POST',
                body: formData
            }).then(response => response.json())
              .then(data => {
                  if (data.status === 'success') {
                      addLog('âœ… Ø¨Ø¯Ø¡ Ø§Ù„Ù‡Ø¬ÙˆÙ…: ' + type, 'attack');
                  }
              });
        }
        
        function stopAllAttacks() {
            fetch('/attack/stop', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'stopped') {
                        addLog('â¹ï¸ ØªÙˆÙ‚Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‡Ø¬Ù…Ø§Øª', 'system');
                    }
                });
        }
        
        function startNetworkScan() {
            fetch('/scan/networks', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    addLog('ğŸ“Š ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø´Ø¨ÙƒØ§Øª', 'scan');
                });
        }
        
        function startBluetoothScan() {
            fetch('/scan/bluetooth', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    addLog('ğŸ“± ØªÙ… Ù…Ø³Ø­ Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø¨Ù„ÙˆØªÙˆØ«', 'scan');
                });
        }
        
        // âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function toggleStealth() {
            fetch('/security/stealth', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    const btn = document.getElementById('stealthBtn');
                    btn.textContent = data.stealth_mode ? 'ğŸ‘» ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØªØ®ÙÙŠ' : 'ğŸ‘» ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ®ÙÙŠ';
                });
        }
        
        function cleanTraces() {
            if (confirm('âš ï¸ Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø­Ùˆ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¢Ø«Ø§Ø±ØŸ')) {
                fetch('/security/clean', { method: 'POST' })
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'cleaned') {
                            addLog('âœ… ØªÙ… Ù…Ø­Ùˆ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¢Ø«Ø§Ø±', 'system');
                            clearLogs();
                        }
                    });
            }
        }
        
        // ğŸ¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        document.getElementById('themeSelect').addEventListener('change', function() {
            updateSetting('theme', this.value);
        });
        
        document.getElementById('languageSelect').addEventListener('change', function() {
            updateSetting('language', this.value);
        });
        
        function toggleTextSize() {
            const btn = document.getElementById('textSizeBtn');
            const current = btn.textContent.includes('ØªÙƒØ¨ÙŠØ±');
            updateSetting('largeText', !current);
        }
        
        function updateSetting(key, value) {
            const formData = new FormData();
            formData.append(key, value);
            
            fetch('/settings/update', {
                method: 'POST',
                body: formData
            }).then(() => location.reload());
        }
        
        // ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        function refreshStatus() {
            fetch('/system/status')
                .then(response => response.json())
                .then(data => {
                    updateStatusDisplay(data);
                    addLog('ğŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…', 'system');
                });
        }
        
        function showSystemInfo() {
            fetch('/system/info')
                .then(response => response.json())
                .then(data => {
                    const info = `
ğŸ¤– Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…:
â€¢ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„: ${data.chip_model}
â€¢ ØªØ±Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬: ${data.cpu_freq} MHz
â€¢ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø­Ø±Ø©: ${data.free_heap} bytes
â€¢ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†: ${data.clients}
â€¢ Ø¹Ù†ÙˆØ§Ù† IP: ${data.ip}
                    `;
                    alert(info);
                });
        }
        
        // ğŸ’¥ ÙˆØ¸Ø§Ø¦Ù Ù…ØªÙ‚Ø¯Ù…Ø©
        function showAdvancedBluetooth() {
            alert('ğŸš§ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...');
        }
        
        function showDestructConfirm() {
            if (confirm('ğŸ’€ ØªØ­Ø°ÙŠØ±: Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡!\nÙ‡Ù„ ØªØ±ÙŠØ¯ ÙØ¹Ù„Ø§Ù‹ Ø§Ù„ØªØ¯Ù…ÙŠØ± Ø§Ù„Ø¢Ù…Ù†ØŸ')) {
                addLog('âš ï¸ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¯Ù…ÙŠØ± Ø§Ù„Ø¢Ù…Ù†...', 'system');
                // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API Ù„Ù„ØªØ¯Ù…ÙŠØ± Ù‡Ù†Ø§
            }
        }
        
        // ğŸš€ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
        document.addEventListener('DOMContentLoaded', function() {
            connectWebSocket();
            refreshStatus();
            refreshLogs();
            
            // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            document.getElementById('themeSelect').value = ')raw" + currentTheme + R"raw(';
            document.getElementById('languageSelect').value = ')raw" + language + R"raw(';
            document.getElementById('textSizeBtn').textContent = ')raw" + (largeText ? "ğŸ” ØªØµØºÙŠØ± Ø§Ù„Ù†Øµ" : "ğŸ” ØªÙƒØ¨ÙŠØ± Ø§Ù„Ù†Øµ") + R"raw(';
        });
    </script>
</body>
</html>
        )raw";
        
        return html;
    }
};

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// ğŸš€ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù…
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
RTXGhostSystem rtx_system;

void setup() {
    rtx_system.begin();
}

void loop() {
    rtx_system.run();
    delay(10);
}
